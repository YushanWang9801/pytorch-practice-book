# é™„å½•ï¼šTensor æ“ä½œå¤§å…¨ï¼ˆç´¢å¼•ã€å˜å½¢ã€ç»´åº¦ã€å¹¿æ’­ç­‰ï¼‰

æœ¬ç« è¡¥å…… PyTorch ä¸­å¸¸è§çš„ Tensor æ“ä½œï¼ŒåŒ…æ‹¬ç»´åº¦å˜æ¢ã€ç´¢å¼•ã€è½¬ç½®ä¸å¹¿æ’­ç­‰ï¼Œé€‚ç”¨äºå¤„ç†å›¾åƒã€æ–‡æœ¬ã€åºåˆ—ç­‰ä¸åŒå½¢çŠ¶çš„æ•°æ®ã€‚

---

## ğŸ” ç´¢å¼•ä¸åˆ‡ç‰‡

PyTorch Tensor çš„ç´¢å¼•å’Œ NumPy ç±»ä¼¼ã€‚

```python
import torch

x = torch.tensor([[1, 2, 3], [4, 5, 6]])

print(x[0])      # ç¬¬ä¸€è¡Œ
print(x[:, 1])   # ç¬¬äºŒåˆ—
print(x[1, 2])   # ç¬¬äºŒè¡Œç¬¬ä¸‰åˆ—
print(x[-1])     # æœ€åä¸€è¡Œ
```

---

## ğŸ”„ View / Reshape

`view()` å’Œ `reshape()` éƒ½å¯ä»¥æ”¹å˜ Tensor çš„å½¢çŠ¶ã€‚

```python
x = torch.arange(12)
x1 = x.view(3, 4)       # åŸåœ°é‡æ„ï¼Œè¦æ±‚å†…å­˜è¿ç»­
x2 = x.reshape(2, 6)    # æ›´çµæ´»ï¼Œæ”¯æŒéè¿ç»­å†…å­˜

print(x1)
print(x2)
```

---

## ğŸª Squeeze / Unsqueeze

`squeeze()` å»é™¤ç»´åº¦ä¸º 1 çš„ç»´åº¦ï¼›`unsqueeze()` å¢åŠ ç»´åº¦ã€‚

```python
x = torch.rand(1, 3, 1)

x1 = x.squeeze()           # (1,3,1) â†’ (3)
x2 = x.unsqueeze(0)        # (1,3,1) â†’ (1,1,3,1)

print(x.shape, x1.shape, x2.shape)
```

å¸¸ç”¨äºæ•°æ®å‡†å¤‡ã€æ‰¹å¤„ç†ã€å·ç§¯è¾“å…¥ç­‰ã€‚

---

## ğŸ” Transpose / .t() / Permute

### 1. `.t()` åªé€‚ç”¨äº 2D Tensor

```python
x = torch.tensor([[1, 2], [3, 4]])
print(x.t())  # è½¬ç½®
```

### 2. `transpose(dim0, dim1)`

```python
x = torch.rand(2, 3, 4)
x_t = x.transpose(1, 2)  # äº¤æ¢ç¬¬1å’Œç¬¬2ç»´
```

### 3. `permute(*dims)` å¯ä»»æ„é‡æ’æ‰€æœ‰ç»´åº¦

```python
x = torch.rand(2, 3, 4)
x_p = x.permute(2, 0, 1)  # (4, 2, 3)
```

---

## ğŸ” Expand / Repeat

ç”¨äºå¹¿æ’­æ‰©å±•å¼ é‡ç»´åº¦

### `expand()`ï¼šå…±äº«å†…å­˜ï¼ˆä»…æ”¯æŒæ‰©å±•ä¸º 1 çš„ç»´åº¦ï¼‰

```python
x = torch.tensor([[1], [2], [3]])  # shape = (3, 1)
x_exp = x.expand(3, 4)             # shape = (3, 4)
```

### `repeat()`ï¼šçœŸå®å¤åˆ¶æ•°æ®

```python
x = torch.tensor([1, 2, 3])
x_rep = x.repeat(2, 3)  # shape = (2, 9)
```

| åŒºåˆ«     | expand | repeat |
| ------ | ------ | ------ |
| å†…å­˜å…±äº«   | âœ…      | âŒ      |
| æ˜¯å¦å¤åˆ¶æ•°æ® | å¦      | æ˜¯      |
| æ˜¯å¦å¿«    | âœ…      | æ…¢      |

---

## ğŸ² å¸¸ç”¨éšæœºæ•°æ“ä½œ

```python
# å‡åŒ€åˆ†å¸ƒ [0,1)
torch.rand(2, 3)

# æ ‡å‡†æ­£æ€åˆ†å¸ƒ N(0,1)
torch.randn(2, 3)

# æ•´æ•°å‡åŒ€åˆ†å¸ƒ
torch.randint(low=0, high=10, size=(2, 3))

# å‡åŒ€åˆ†å¸ƒ [a,b]
torch.empty(2, 2).uniform_(2.0, 5.0)

# æ­£æ€åˆ†å¸ƒ N(Î¼, ÏƒÂ²)
torch.empty(3, 3).normal_(mean=0.0, std=2.0)

# è®¾ç½®éšæœºç§å­ï¼ˆä¿è¯å¯å¤ç°ï¼‰
torch.manual_seed(42)
```

---

## âœ… å°ç»“

| æ“ä½œç±»å‹    | å‡½æ•°                                                          |
| ------- | ----------------------------------------------------------- |
| ç»´åº¦å˜æ¢    | `view()`, `reshape()`                                       |
| æ·»åŠ /å»æ‰ç»´åº¦ | `unsqueeze()`, `squeeze()`                                  |
| è½¬ç½®      | `t()`, `transpose()`, `permute()`                           |
| æ‰©å±•å¼ é‡    | `expand()`, `repeat()`                                      |
| éšæœºåˆå§‹åŒ–   | `rand()`, `randn()`, `randint()`, `uniform_()`, `normal_()` |

ç†è§£è¿™äº› Tensor æ“ä½œå¯¹å›¾åƒå¤„ç†ã€NLPã€æ—¶é—´åºåˆ—ç­‰é¢†åŸŸéƒ½éå¸¸é‡è¦ï¼Œèƒ½æå¤§æå‡ä½ æ“ä½œæ•°æ®çš„æ•ˆç‡ã€‚